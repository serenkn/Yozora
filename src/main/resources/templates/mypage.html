<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja">

<head>
    <meta charset="UTF-8">
    <title>„Éû„Ç§„Éö„Éº„Ç∏</title>
    <link rel="stylesheet" th:href="@{/css/mypage.css}">
    <link rel="stylesheet" th:href="@{/css/footer.css}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css">
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js" defer></script>
    <script th:src="@{/js/post.js}" defer></script>

</head>

<body>
    <main>
        <!-- „Éó„É≠„Éï„Ç£„Éº„É´„Éò„ÉÉ„ÉÄ„Éº -->
        <header class="profile-header">
            <!-- „É≠„Ç∞„Ç¢„Ç¶„Éà„Éú„Çø„É≥ -->
            <div class="logout-wrapper">
                <form th:action="@{/logout}" method="post">
                    <button type="submit" class="link-button">„É≠„Ç∞„Ç¢„Ç¶„Éà</button>
                </form>
            </div>

            <!-- „Éó„É≠„Éï„Ç£„Éº„É´„Ç®„É™„Ç¢ -->
            <div class="profile-horizontal">
                <!-- „Éó„É≠„Éï„Ç£„Éº„É´ÁîªÂÉè -->
                <div class="profile-image">
                    <img th:src="${user.profileImage}" alt="„Éó„É≠„Éï„Ç£„Éº„É´ÁîªÂÉè">
                </div>

                <!-- „Éó„É≠„Éï„Ç£„Éº„É´ÊÉÖÂ†± -->
                <div class="profile-info">
                    <p class="user-name" th:text="${user.userName}">„É¶„Éº„Ç∂„ÉºÂêç</p>
                    <div class="profile-stats">
                        <div><strong th:text="${postList != null ? postList.size() : 0}">0</strong> ÊäïÁ®ø</div>
                        <div><strong th:text="${followerCount}">0</strong> „Éï„Ç©„É≠„ÉØ„Éº</div>
                        <div><strong th:text="${followCount}">0</strong> „Éï„Ç©„É≠„Éº‰∏≠</div>
                    </div>
                    <div class="profile-actions">
                        <a th:href="@{/userEdit}" class="edit-btn">„Éó„É≠„Éï„Ç£„Éº„É´„ÇíÁ∑®ÈõÜ</a>
                    </div>
                </div>
            </div>
        </header>

        <!-- ÊäïÁ®ø‰∏ÄË¶ß -->
        <section class="post-list">
            <!-- ÊäïÁ®ø„Åå„Å™„ÅÑÂ†¥Âêà„ÅÆË°®Á§∫ -->
            <div class="no-posts" th:if="${postList == null or postList.isEmpty()}">
                <p>ÊäïÁ®ø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>
            </div>

            <!-- ÊäïÁ®ø„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅÆË°®Á§∫ -->
            <div class="posts-container" th:if="${postList != null and !postList.isEmpty()}">
                <div th:each="post : ${postList}" class="post-item">

                    <!-- ÁîªÂÉèË§áÊï∞ÊûöË°®Á§∫ -->
                    <div class="swiper post-carousel" th:if="${post.imageUrls != null}">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide" th:each="img : ${post.imageUrls}">
                                <img th:src="${img}" alt="ÊäïÁ®øÁîªÂÉè" class="carousel-image">
                            </div>
                        </div>
                        <div class="swiper-pagination"></div>
                        <div class="swiper-button-prev"></div>
                        <div class="swiper-button-next"></div>
                    </div>

                    <!-- ÊäïÁ®øÊó•ÊôÇ -->
                    <p class="post-date" th:text="${#temporals.format(post.createdAt, 'yyyy/MM/dd HH:mm')}"></p>

                    <!-- „ÅÑ„ÅÑ„Å≠„Éú„Çø„É≥ -->
                    <button class="likeBtn" th:data-post-id="${post.id}" th:data-liked="${post.liked}"
                        th:onclick="|toggleLike(this)|">
                        <span th:if="${post.liked}">‚≠ê</span>
                        <span th:unless="${post.liked}">‚òÖ</span>
                        <span id="like-count" th:text="${post.likeCount}">0</span>
                    </button>

                    <!--„ÄÄ„Ç≥„É°„É≥„ÉàÊï∞ -->
                    <p class="comments" th:text="'üí¨ ' + ${post.commentCount}">0</p>

                    <!-- „É´„Éº„Éà„Éú„Çø„É≥ -->
                    <button type="button" class="route-btn" th:if="${post.latitude != null and post.longitude != null}"
                        th:onclick="|openGoogleMapsRoute(${post.latitude}, ${post.longitude})|">
                        üìç„É´„Éº„Éà
                    </button>

                    <!-- „Çø„Ç§„Éà„É´ -->
                    <p class="post-title" th:text="${post.title}"></p>

                    <!-- Êú¨Êñá -->
                    <p class="post-text" th:text="${post.text}"></p>

                    <!-- ‰ΩèÊâÄ -->
                    <p class="post-address" th:text="${post.address}"></p>

                    <!-- Ë©≥Á¥∞„Éö„Éº„Ç∏„Å∏ -->
                    <form action="/post">
                        <input type="hidden" name="id" th:value="${post.id}"></input>
                        <button type="submit">Ë©≥Á¥∞„ÅØ„Åì„Å°„Çâ„Å∏</button>
                    </form>
                    <!-- Á∑®ÈõÜ„ÉªÂâäÈô§„Éú„Çø„É≥ -->
                    <div class="post-actions">
                        <a th:href="@{/post/edit/{id}(id=${post.id})}" class="btn">Á∑®ÈõÜ</a>
                        <form th:action="@{/post/delete}" method="post" onsubmit="return confirm('Êú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü');">
                            <input type="hidden" name="id" th:value="${post.id}">
                            <input type="submit" value="ÂâäÈô§" class="delete-btn">
                        </form>
                    </div>

                </div>
            </div>
        </section>
    </main>

    <!-- „Éï„ÉÉ„Çø„Éº -->
    <div th:replace="~{fragments/footer :: footer}"></div>

</body>

</html>